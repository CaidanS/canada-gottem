<!DOCTYPE html>
<head>
    <title>Canada Gottem</title>
    <link rel="stylesheet" href="main.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://js.stripe.com/v3/"></script>
    <script src="site.js"></script>
</head>
<body> 
    <div id="main-grid">
        <div id="header">
            <h1 style="font-family: death;">Canada Gottem&trade;</h1>
            <!-- <marquee direction="down"><h1>Canada Gottem&trade;Canada Gottem&trade;Canada Gottem&trade;</h1></marquee> -->
        </div>
        <div id="sticker">
            <h1 style="background-color: tomato;">Sticker: $3</h1>
            <div class="add-to-cart">
                <button class="add-button" id="minus" onclick="adjustValue('down','sticker')"><h2>-</h2></button>
                <span id="sticker-count" class="count"><h1>1</h1></span>
                <button class="add-button" id="plus" onclick="adjustValue('up','sticker')"><h2>+</h2></button>
            </div>
        </div>
        <div id="patch">
            <h1 style="background-color: magenta;">Patch: $8</h1>
            <div class="add-to-cart">
                <button class="add-button" id="minus" onclick="adjustValue('down','patch')"><h2>-</h2></button>
                <span id="patch-count" class="count"><h1>1</h1></span>
                <button class="add-button" id="plus" onclick="adjustValue('up','patch')"><h2>+</h2></button>
            </div>
        </div>
        <div id="checkout">            
            <button id="checkout-button" onclick="checkout()">Current Total: $<span id="total">11</span>. <span style="text-decoration: underline; color: navy;">Checkout!</span></button>
<div id="error-message"></div>
<script>
(function() {
  var stripe = Stripe('pk_live_51K64EeAHI4v7SeoPWxXkblD0ml9NbzIqfH8gErUhW1eXsz77YSidOW2ZdO9gahDHUZXqWnQdZDKOZM9sfSaIEY2I00jZdWVkq0');
  var checkoutButton = document.getElementById('checkout-button');
  checkoutButton.addEventListener('click', function () {
    /*
     * When the customer clicks on the button, redirect
     * them to Checkout.
     */
    stripe.redirectToCheckout({
      lineItems: [{price: 'price_1K64SVAHI4v7SeoPZ2qQEkQO', quantity: cart["sticker"]}, {price: 'price_1K64SFAHI4v7SeoPEz0ZxHN3', quantity: cart["patch"]}],
      mode: 'payment',
      /*
       * Do not rely on the redirect to the successUrl for fulfilling
       * purchases, customers may not always reach the success_url after
       * a successful payment.
       * Instead use one of the strategies described in
       * https://stripe.com/docs/payments/checkout/fulfill-orders
       */
      successUrl: 'https://sad-austin-4cde65.netlify.app/success',
      cancelUrl: 'https://sad-austin-4cde65.netlify.app/',
    })
    .then(function (result) {
      if (result.error) {
        /*
         * If `redirectToCheckout` fails due to a browser or network
         * error, display the localized error message to your customer.
         */
        var displayError = document.getElementById('error-message');
        displayError.textContent = result.error.message;
      }
    });
  });
})();
</script>
        </div>
    </div>
    <div id="myModal" class="modal">

        <!-- Modal content -->
        <div class="modal-content">
          <span class="close">&times;</span>
          <p>Thank you for your purchase of totally legit authentic <span style="font-family: death; color: orange;">Canada Gottem&trade;</span> Happy flexing!</p>
          <a href="https://www.instagram.com/canada_gottem/">Follow the instagram if you're cool &#128553;</a></p>
        </div>
      
      </div>
      <script>

// Get the modal
var modal = document.getElementById("myModal");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];




// When the user clicks on <span> (x), close the modal
span.onclick = function() {
  modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}
// When the user clicks on the button, open the modal
if(window.location.hash) {
      var hash = window.location.hash.substring(1); //Puts hash in variable, and removes the # character
      if(hash == "success"){
        modal.style.display = "block";
      }
      // hash found
}
      </script>
</body>